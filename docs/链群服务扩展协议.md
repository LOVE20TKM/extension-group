# 链群服务扩展协议

## 1. 关于协议

此扩展协议基于 LOVE20 扩展协议标准，扩展行动参与机制，对链群行动中的链群服务者做激励。

- 参与方式：在链群行动中激活链群，并服务链群行动参与者；同时参与链群服务行动
- 自动计算：链上自动计算铸币激励
- 激励分配：支持以链群为单位设置多个接收地址和分配比例，在铸造激励时自动分配

## 2. 初始参数

- 链群服务所在代币地址
- 链群行动所在代币地址：仅限链群服务所在代币地址或其子币地址
- 链群行动扩展协议工厂合约地址

## 3. 激励铸造

链群服务激励 = 链群服务行动总激励 × 链群服务者所服务的所有链群的铸币激励 / 所有链群行动的行动激励总和

注意，这里的链群行动是指：在链群行动所在代币地址下，由链群行动工厂合约创建的扩展协议所关联的行动。

## 4. 激励分配

链群服务激励可以设置二次分配，在铸造激励时自动分配到设置的所有地址，剩余部分分配到链群服务者地址。

### 4.1 分配设置

链群服务者可以在验证阶段对行动下的链群进行分配设置。

- 设置维度：每个行动下的每个链群可以有不同的分配设置
- 总和不能超过 100%
- 接收地址最多可设置 10 个地址
- 同一阶段可多次设置，以最后一次设置为准
- 若当轮未设置，则向前查找该链群最近一轮的设置
- 链群服务者在领取激励时，按每个链群的分配设置自动分配激励

### 4.2 分配计算

激励按链群维度分别计算：

```
链群A的激励 = 链群服务总激励 × 链群A铸币激励 / 所有链群行动总激励

链群A某接收地址收到激励 = 链群A的激励 × 该地址分配比例
链群A链群服务者收到激励 = 链群A的激励 - 链群A所有接收地址激励之和
```
